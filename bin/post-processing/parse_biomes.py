import argparse
import pandas as pd
import os



if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="Parse the protein query results into biome sunburst count CSVs.")
    parser.add_argument("postprocessing_dir", help="Path to the output post-processing files generated by the query_mgnprotein_db module")
    # python3 bin/post-processing/parse_biomes.py /home/vangelis/Desktop/Projects/mgnifams/output/post-processing
    args = parser.parse_args()

    query_results_dir = os.path.join(args.postprocessing_dir, "query_results")
    if not os.path.exists(query_results_dir):
        raise FileNotFoundError(f"The folder {query_results_dir} does not exist.")

    biome_mapping_path = os.path.join(args.postprocessing_dir, "biome_mapping.tsv")
    if not os.path.exists(biome_mapping_path):
        raise FileNotFoundError(f"The file {biome_mapping_path} does not exist.")

    biome_mapping_df = pd.read_csv(biome_mapping_path, sep='\t', header=None, names=['id', 'name'])
    
    
    
